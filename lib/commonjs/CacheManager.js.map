{"version":3,"names":["_sha","_interopRequireDefault","require","_reactNativeFileAccess","_defaultConfiguration","obj","__esModule","default","retry","fn","retriesLeft","arguments","length","undefined","CacheManager","config","maxRetries","interval","retryDelay","request","status","Error","error","message","Promise","resolve","setTimeout","CacheEntry","pathResolved","noCache","constructor","source","options","maxAge","getPath","exists","path","getCacheEntry","downloadPromise","download","result","FileSystem","fetch","e","__DEV__","console","log","cacheLimit","pruneCache","exports","defaultConfig","defaultConfiguration","newConfig","entries","get","_CacheManager$entries","_options$headers","headers","Authorization","clearCache","baseDir","files","ls","file","unlink","removeCacheEntry","entry","getCacheSize","stat","size","isImageCached","prefetch","forEach","image","prefetchBlob","blob","readFile","statDir","sort","a","b","lastModified","currentCacheSize","reduce","cacheSize","overflowSize","shift","catch","cacheKey","newCacheKey","getCustomCacheKey","filename","substring","lastIndexOf","indexOf","ext","sha","SHA1","mkdir","ageInHours","Math","floor","Date","now"],"sourceRoot":"../../src","sources":["CacheManager.ts"],"mappings":"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"}